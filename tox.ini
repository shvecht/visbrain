[tox]
minversion = 4.11.0
env_list =
    lint
    tests
    package

[testenv]
deps = -r requirements/dev.txt

[testenv:lint]
description = Run Ruff against the repository
skip_install = true
commands =
    ruff check {posargs:.}

[testenv:tests]
description = Run the test suite headlessly with coverage
setenv =
    QT_QPA_PLATFORM = offscreen
    PYTHONWARNINGS = default
passenv =
    PYTEST_MARK
commands =
    python -m pytest --cov=visbrain --cov-report=term-missing -m "{env:PYTEST_MARK:not gui}" {posargs}

[testenv:package]
description = Build sdist and wheel artifacts
skip_install = true
commands =
    python -m build {posargs}
